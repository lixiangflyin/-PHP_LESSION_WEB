<?php
/*

设置顶层异常处理器 （Top Level Exception Handler）
set_exception_handler() 函数可设置处理所有未捕获异常的用户定义函数。

 */

//自定义 的异常
class EmailFormatException extends Exception
{
	public function errorMessage()
	{
		$errorMsg = 'Error on line ' . $this->getLine() . ' in ' . $this->getFile()
		. ': <b>' . $this->getMessage() . '</b> is not a valid E-Mail Address ';
		
		return $errorMsg;
	}
}


//顶层异常处理器 
function  myExceptionHandler($e)
{
	echo $e->errorMessage();
}

set_exception_handler('myExceptionHandler');

$email = 'someone@example...come';


if(filter_var($email,FILTER_VALIDATE_EMAIL) == false )
{
	throw  new EmailFormatException($email, 400);
}





/**
Content-type: text/html

Error on line 28 in F:\opt\www\36_PHP_Exception_custom_exception\01_custonException.php: <b>someone@example...come</b> is not a valid E-Mail Address 
*/
?>